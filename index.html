<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>ÎØºÌÇà Ïπ¥Îìú Í∞ÄÏ±†Í≤åÏûÑ</title>
    
    <!-- PWA ÏÑ§Ï†ï -->
    <meta name="description" content="ÎØºÌÇà Ï∫êÎ¶≠ÌÑ∞Îì§Ïùò Ïπ¥ÎìúÎ•º ÏàòÏßëÌïòÍ≥† Ï°∞Ìï©ÌïòÎäî Í∞ÄÏ±† Í≤åÏûÑ">
    <meta name="keywords" content="ÎØºÌÇà, Í∞ÄÏ±†, Ïπ¥ÎìúÍ≤åÏûÑ, ÏàòÏßëÍ≤åÏûÑ, Ï°∞Ìï©Í≤åÏûÑ">
    <meta name="author" content="ÎØºÌÇà Í∞ÄÏ±† Í≤åÏûÑ">
    <meta name="theme-color" content="#16213e">
    <meta name="apple-mobile-web-app-title" content="ÎØºÌÇà Í∞ÄÏ±†">
    <meta name="msapplication-TileColor" content="#16213e">
    
    <!-- Open Graph Î©îÌÉÄ ÌÉúÍ∑∏ -->
    <meta property="og:title" content="ÎØºÌÇà Ïπ¥Îìú Í∞ÄÏ±†Í≤åÏûÑ">
    <meta property="og:description" content="ÎØºÌÇà Ï∫êÎ¶≠ÌÑ∞Îì§Ïùò Ïπ¥ÎìúÎ•º ÏàòÏßëÌïòÍ≥† Ï°∞Ìï©ÌïòÎäî Í∞ÄÏ±† Í≤åÏûÑ">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://minqui-gacha.vercel.app">
    <meta property="og:image" content="/icons/icon-512x512.png">
    <meta property="og:site_name" content="ÎØºÌÇà Í∞ÄÏ±† Í≤åÏûÑ">
    
    <!-- Twitter Ïπ¥Îìú -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ÎØºÌÇà Ïπ¥Îìú Í∞ÄÏ±†Í≤åÏûÑ">
    <meta name="twitter:description" content="ÎØºÌÇà Ï∫êÎ¶≠ÌÑ∞Îì§Ïùò Ïπ¥ÎìúÎ•º ÏàòÏßëÌïòÍ≥† Ï°∞Ìï©ÌïòÎäî Í∞ÄÏ±† Í≤åÏûÑ">
    <meta name="twitter:image" content="/icons/icon-512x512.png">
    
    <!-- PWA Îß§ÎãàÌéòÏä§Ìä∏ -->
    
    <!-- ÏïÑÏù¥ÏΩò -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-16x16.png">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/icons/icon-192x192.png">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Animation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>

    <!-- html2canvas ÎùºÏù¥Î∏åÎü¨Î¶¨ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- ÌååÌã∞ÌÅ¥ Î∞∞Í≤Ω -->
    <div id="particles-js"></div>

    <!-- Í∞ÄÏ±† Ïù¥ÌéôÌä∏ Ïò§Î≤ÑÎ†àÏù¥ -->
    <div id="gacha-effects" class="gacha-effects"></div>


    <!-- ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
    <div class="tab-navigation">
        <button class="tab-button active" data-tab="gacha">Í∞ÄÏ±†</button>
        <button class="tab-button" data-tab="collection">Ïª¨Î†âÏÖò</button>
        <button class="tab-button" data-tab="fusion">Ï°∞Ìï©</button>
    </div>

    <!-- Ìã∞Ïºì ÏãúÏä§ÌÖú -->
    <div class="ticket-system">
        <div class="ticket-display">
            <div class="ticket-icon">üé´</div>
            <div class="ticket-info">
                <div class="ticket-count">
                    <span id="ticketCount">0</span>/10
                </div>
                <div class="ticket-timer" id="ticketTimer">
                    Îã§Ïùå Ï∂©Ï†ÑÍπåÏßÄ: --:--:--
                </div>
            </div>
        </div>
    </div>

    
    <!-- Í∞ÄÏ±† ÌÉ≠ Ïª®ÌÖêÏ∏† -->
    <div class="tab-content active" id="gacha-tab">
        <div class="card-container">
            <div class="card-wrapper" id="cardWrapper" draggable="false" ondragstart="return false;" onselectstart="return false;" oncontextmenu="return false;" onmousedown="return false;">
            <!-- ÏïûÎ©¥ -->
            <div class="card-front">
                <!-- ÌôÄÎ°úÍ∑∏ÎûòÌîΩ ÌîÑÎ†àÏûÑ Ìö®Í≥º Ï†úÍ±∞Îê® -->
                <!-- Î∞∞Í≤Ω ÏùºÎü¨Ïä§Ìä∏ -->
                <div class="card-background-illustration">
                    <img id="cardBackground" alt="Ïπ¥Îìú Î∞∞Í≤Ω ÏùºÎü¨Ïä§Ìä∏" class="background-illust">
                </div>
                <!-- Í∏ÄÎ°úÏä§ Ìö®Í≥º Î†àÏù¥Ïñ¥ - ÏùºÎü¨Ïä§Ìä∏ ÏúÑÏóê Ïú†ÏßÄ -->
                <div class="card__gloss" aria-hidden="true"></div>
                
                <!-- Ïπ¥Îìú Ï†ïÎ≥¥ Î∞ïÏä§ -->
                <div class="card-info-box">
                    <div class="card-number-box">
                        <div class="card-number" id="cardNumber"></div>
                    </div>
                    <div class="card-name" id="cardName"></div>
                </div>
                
                <!-- Ïπ¥Îìú Ï†ïÎ≥¥ Î∞ïÏä§ Î≥µÏÇ¨Î≥∏ - Ï∫êÎ¶≠ÌÑ∞ ÏïûÏóê Î∞∞Ïπò -->
                <div class="card-info-box-overlay">
                    <div class="card-number-box">
                        <div class="card-number" id="cardNumberOverlay"></div>
                    </div>
                    <div class="card-name" id="cardNameOverlay"></div>
                </div>
                
                <!-- Îû≠ÌÅ¨ ÌëúÏãú -->
                <div class="card-rank" id="cardRank">
                    <img id="rankImage" alt="Îû≠ÌÅ¨ Ïù¥ÎØ∏ÏßÄ" class="rank-image">
                </div>
                
                
                <!-- ÌïòÎã® Ìà¨Î™Ö Î∞ïÏä§ -->
                <div class="card-bottom-overlay">
                    <div class="stats-container">
                        <div class="stat-item hp-item">
                            <span class="stat-label">HP</span>
                            <span class="stat-value" id="cardHp"></span>
                        </div>
                        <div class="stat-item attack-item">
                            <span class="stat-label">Í≥µÍ≤©Î†•</span>
                            <span class="stat-value" id="cardAttack"></span>
                        </div>
                        <div class="stat-item type-item">
                            <span class="stat-value" id="cardType"></span>
                        </div>
                    </div>
                    
                    <!-- Ïä§ÌÇ¨ Î∞ïÏä§ -->
                    <div class="skill-box">
                        <div class="skill-name" id="skillName"></div>
                        <div class="skill-description" id="skillDescription"></div>
                    </div>
                </div>
                
                <!-- Î∂ÑÎ¶¨Îêú Ï∫êÎ¶≠ÌÑ∞ -->
                <div class="card-character">
                    <img id="cardCharacter" alt="Ï∫êÎ¶≠ÌÑ∞ ÏùºÎü¨Ïä§Ìä∏" class="character-illust">
                </div>
            </div>
            
            <!-- Îí∑Î©¥ -->
            <div class="card-back">
                <img id="backIllust" alt="Ïπ¥Îìú Îí∑Î©¥ ÏùºÎü¨Ïä§Ìä∏" class="back-illust" 
                     onload="console.log('Îí∑Î©¥ Ïù¥ÎØ∏ÏßÄ Î°úÎìú ÏÑ±Í≥µ!')" 
                     onerror="console.log('Îí∑Î©¥ Ïù¥ÎØ∏ÏßÄ Î°úÎìú Ïã§Ìå®:', this.src)">
            </div>
        </div>
        </div>
        </div>
    </div>
    
    <!-- Ïª¨Î†âÏÖò ÌÉ≠ Ïª®ÌÖêÏ∏† -->
    <div class="tab-content" id="collection-tab">
        <!-- ÏõπÏö© Ïª¨Î†âÏÖò UI -->
        <div class="collection-container web-collection">
            <div class="collection-header">
                <div class="collection-stats">
                    <div class="stat-item">
                        <span class="stat-label">Ï¥ù Ïπ¥Îìú</span>
                        <span class="stat-value" id="totalCards">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ÌöçÎìùÎ•†</span>
                        <span class="stat-value" id="collectionRate">0% (0/10)</span>
                    </div>
                </div>
            </div>
            
            <div class="collection-filters">
                <button class="filter-btn active" data-filter="all">Ï†ÑÏ≤¥</button>
                <button class="filter-btn" data-filter="SSS">SSS</button>
                <button class="filter-btn" data-filter="SS">SS</button>
                <button class="filter-btn" data-filter="S">S</button>
                <button class="filter-btn" data-filter="A">A</button>
                <button class="filter-btn" data-filter="B">B</button>
            </div>
            
            <div class="collection-grid" id="collectionGrid">
                <!-- Ïπ¥ÎìúÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
            </div>
        </div>
        
        <!-- Î™®Î∞îÏùºÏö© Ïª¨Î†âÏÖò UI -->
        <div class="mobile-collection-container mobile-collection" style="display: none;">
            <div class="mobile-collection-header">
                <div class="mobile-stats-row">
                    <div class="mobile-stat-item">
                        <span class="mobile-stat-label">Ï¥ù Ïπ¥Îìú</span>
                        <span class="mobile-stat-value" id="mobileTotalCards">0</span>
                    </div>
                    <div class="mobile-stat-item">
                        <span class="mobile-stat-label">ÌöçÎìùÎ•†</span>
                        <span class="mobile-stat-value" id="mobileCollectionRate">0%</span>
                    </div>
                </div>
            </div>
            
            <div class="mobile-filter-section">
                <div class="mobile-filter-row">
                    <button class="mobile-filter-btn active" data-filter="all">Ï†ÑÏ≤¥</button>
                    <button class="mobile-filter-btn" data-filter="SSS">SSS</button>
                    <button class="mobile-filter-btn" data-filter="SS">SS</button>
                </div>
                <div class="mobile-filter-row">
                    <button class="mobile-filter-btn" data-filter="S">S</button>
                    <button class="mobile-filter-btn" data-filter="A">A</button>
                    <button class="mobile-filter-btn" data-filter="B">B</button>
                </div>
            </div>
            
            <div class="mobile-collection-list" id="mobileCollectionList">
                <!-- Î™®Î∞îÏùºÏö© Ïπ¥Îìú Î¶¨Ïä§Ìä∏Í∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
            </div>
        </div>
    </div>
    
    <!-- Ï°∞Ìï© ÌÉ≠ Ïª®ÌÖêÏ∏† -->
    <div class="tab-content" id="fusion-tab">
        <div class="fusion-container">
            
            <!-- Ï°∞Ìï© ÎåÄÏÉÅ Ïπ¥Îìú ÏòÅÏó≠ -->
            <div class="fusion-target-section">
                <div class="target-header">
                    <span class="target-label">Ï°∞Ìï©ÎåÄÏÉÅÏπ¥Îìú</span>
                </div>
                
                <!-- Ïπ¥Îìú ÌïÑÌÑ∞ -->
                <div class="card-filters">
                    <button class="filter-btn active" data-filter="all">ÎåÄÏÉÅ</button>
                    <button class="filter-btn" data-filter="B">B</button>
                    <button class="filter-btn" data-filter="A">A</button>
                    <button class="filter-btn" data-filter="S">S</button>
                    <button class="filter-btn" data-filter="SS">SS</button>
                    <button class="filter-btn" data-filter="SSS">SSS</button>
                </div>
                
                <!-- Ïπ¥Îìú Í∑∏Î¶¨Îìú -->
                <div class="fusion-card-grid" id="fusionCardGrid">
                    <!-- ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Ïπ¥ÎìúÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>
            
            <!-- Ï°∞Ìï© Ïä¨Î°Ø ÏòÅÏó≠ -->
            <div class="fusion-slot-section">
                <div class="slot-header">
                    <span class="slot-label">Ï°∞Ìï© Ïä¨Î°Ø (ÏµúÏÜå 3Ïû•)</span>
                </div>
                
                <div class="fusion-slots" id="fusionSlots">
                    <!-- Ï°∞Ìï© Ïä¨Î°ØÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
                
                <div class="fusion-info" id="fusionInfo">
                    <div class="info-toggle" id="infoToggle">i</div>
                    <div class="probability-tooltip" id="probabilityTooltip" style="display: none;">
                        <!-- Ï†ÑÏ≤¥ Îû≠ÌÅ¨Î≥Ñ ÌôïÎ•†Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                    </div>
                </div>
                
                <button class="fusion-button" id="fusionButton" disabled>
                    <span class="button-text">Ï°∞Ìï©ÌïòÍ∏∞</span>
                    <span class="button-icon">‚ö°</span>
                </button>
            </div>
            
            <!-- Î£∞Î†õ Î™®Îã¨ -->
            <div class="roulette-modal" id="rouletteModal" style="display: none;">
                <div class="roulette-content">
                    <div class="roulette-header">
                        <h2>Ï°∞Ìï© Ï§ë...</h2>
                    </div>
                    <div class="roulette-body">
                        <div class="roulette-container">
                            <div class="roulette-wheel" id="rouletteWheel">
                                <!-- Î£∞Î†õ Ïπ¥ÎìúÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                            </div>
                            <div class="roulette-pointer"></div>
                        </div>
                        <div class="roulette-result" id="rouletteResult">
                            <!-- ÏµúÏ¢Ö Í≤∞Í≥ºÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ï°∞Ìï© Í≤∞Í≥º Î™®Îã¨ -->
            <div class="fusion-result-modal" id="fusionResultModal" style="display: none;">
                <div class="modal-content">
                    <div class="result-card-display" id="resultCardDisplay">
                        <!-- Ï°∞Ìï© Í≤∞Í≥º Ïπ¥ÎìúÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                    </div>
                    <div class="result-message">
                        <p id="resultMessage">Ï°∞Ìï© Í≤∞Í≥º Ìï¥Îãπ Ïπ¥ÎìúÍ∞Ä ÎÇòÏôîÏäµÎãàÎã§.</p>
                    </div>
                    <button class="confirm-button" id="confirmButton">ÌôïÏù∏</button>
                </div>
            </div>

        </div>
    </div>

    <!-- Ïπ¥Îìú ÎîîÌÖåÏùº Î™®Îã¨ -->
    <div class="card-detail-modal" id="cardDetailModal" style="display: none;">
        <div class="modal-overlay" id="cardDetailOverlay"></div>
        <div class="modal-content card-detail-content">
            <div class="modal-header">
                <h2 id="modalCardTitle">Ïπ¥Îìú Ï†ïÎ≥¥</h2>
                <button class="close-button" id="cardDetailCloseBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-card-display" id="detailCardDisplay">
                    <!-- Ïπ¥Îìú ÏÉÅÏÑ∏ Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
                <div class="card-stats-info" id="cardStatsInfo">
                    <!-- Ïπ¥Îìú Ïä§ÌÉØ Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="export-png-button" id="exportPngButton">PNGÎ°ú ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
                <button class="close-modal-button" id="closeModalButton">Îã´Í∏∞</button>
            </div>
        </div>
    </div>
    
    
    <script src="api-client.js"></script>
    <script src="utils.js"></script>
    <script src="gacha.js"></script>
    <script src="fusion.js"></script>
    <script src="collection.js"></script>
    <script src="ui.js"></script>
    <script src="data.js"></script>
    <script src="animation.js"></script>
    <script src="script.js"></script>
    
    <!-- PWA Service Worker Îì±Î°ù -->
    <script>
      // Service Worker Îì±Î°ù
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then((registration) => {
              console.log('Service Worker Îì±Î°ù ÏÑ±Í≥µ:', registration.scope);
            })
            .catch((error) => {
              console.log('Service Worker Îì±Î°ù Ïã§Ìå®:', error);
            });
        });
      }
      
      // PWA ÏÑ§Ïπò ÌîÑÎ°¨ÌîÑÌä∏
      let deferredPrompt;
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        
        // ÏÑ§Ïπò Î≤ÑÌäº ÌëúÏãú (ÏÑ†ÌÉùÏÇ¨Ìï≠)
        const installButton = document.createElement('button');
        installButton.textContent = 'Ïï± ÏÑ§Ïπò';
        installButton.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 1000;
          background: #4CAF50;
          color: white;
          border: none;
          padding: 10px 20px;
          border-radius: 5px;
          cursor: pointer;
          font-size: 14px;
        `;
        
        installButton.addEventListener('click', () => {
          deferredPrompt.prompt();
          deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
              console.log('PWA ÏÑ§ÏπòÎê®');
            }
            deferredPrompt = null;
            installButton.remove();
          });
        });
        
        document.body.appendChild(installButton);
        
        // 5Ï¥à ÌõÑ ÏûêÎèôÏúºÎ°ú Î≤ÑÌäº Ïà®Í∏∞Í∏∞
        setTimeout(() => {
          if (installButton.parentNode) {
            installButton.remove();
          }
        }, 5000);
      });
      
      // PWA ÏÑ§Ïπò ÏôÑÎ£å Ïù¥Î≤§Ìä∏
      window.addEventListener('appinstalled', (evt) => {
        console.log('PWAÍ∞Ä ÏÑ§ÏπòÎêòÏóàÏäµÎãàÎã§');
      });
      
      // Ïò§ÌîÑÎùºÏù∏ ÏÉÅÌÉú Í∞êÏßÄ
      window.addEventListener('online', () => {
        console.log('Ïò®ÎùºÏù∏ ÏÉÅÌÉú');
        document.body.classList.remove('offline');
      });
      
      window.addEventListener('offline', () => {
        console.log('Ïò§ÌîÑÎùºÏù∏ ÏÉÅÌÉú');
        document.body.classList.add('offline');
      });
      
      // Í≤åÏûÑ ÏÑ±Îä• ÏµúÏ†ÅÌôî
      let lastTime = 0;
      function gameLoop(currentTime) {
        const deltaTime = currentTime - lastTime;
        lastTime = currentTime;
        
        // 60fpsÎ°ú Ï†úÌïú
        if (deltaTime >= 16.67) {
          // Í≤åÏûÑ Î°úÏßÅ ÏóÖÎç∞Ïù¥Ìä∏
          if (window.game && window.game.update) {
            window.game.update(deltaTime);
          }
        }
        
        requestAnimationFrame(gameLoop);
      }
      
      // Í≤åÏûÑ Î£®ÌîÑ ÏãúÏûë
      requestAnimationFrame(gameLoop);
      
      // ÌéòÏù¥ÏßÄ Í∞ÄÏãúÏÑ± Î≥ÄÍ≤Ω Í∞êÏßÄ (ÏÑ±Îä• ÏµúÏ†ÅÌôî)
      document.addEventListener('visibilitychange', () => {
        if (document.hidden) {
          // ÌéòÏù¥ÏßÄÍ∞Ä Ïà®Í≤®Ï°åÏùÑ Îïå Í≤åÏûÑ ÏùºÏãúÏ†ïÏßÄ
          if (window.game && window.game.pause) {
            window.game.pause();
          }
        } else {
          // ÌéòÏù¥ÏßÄÍ∞Ä Îã§Ïãú Î≥¥Ïùº Îïå Í≤åÏûÑ Ïû¨Í∞ú
          if (window.game && window.game.resume) {
            window.game.resume();
          }
        }
      });
    </script>
</body>
</html>